name: 机场签到

on:
  workflow_dispatch:
  watch:
    types: started
  schedule:
    - cron: '0 21 * * *'
jobs:
  build:
    runs-on: ubuntu-latest
  #  if: github.event.repository.owner.id == github.event.sender.id
  #  env:
  #      QQREAD_BODY: "{\"common\":{\"appid\":1450024394,\"areaid\":5,\"qq_ver\":\"8.4.17\",\"os_ver\":\"iOS 14.3\",\"mp_ver\":\"0.38.2\",\"mpos_ver\":\"1.21.0\",\"brand\":\"iPhone\",\"model\":\"iPhone XS<iPhone11,2>\",\"screenWidth\":375,\"screenHeight\":812,\"windowWidth\":375,\"windowHeight\":729,\"openid\":\"ED60B75D67E3B287FC632F4892E9219F\",\"guid\":2571640167,\"session\":\"8bjqy4c9d1pe1ovtnzoxmqcouwcqnpas\",\"scene\":2016,\"source\":-1,\"hasRedDot\":\"false\",\"missions\":-1,\"caseID\":-1},\"dataList\":[{\"click1\":\"bookDetail_bottomBar_read_C\",\"click2\":\"bookLib_rankBook_bookClick_C\",\"route\":\"pages/book-read/index\",\"refer\":\"pages/book-detail/index\",\"options\":{\"bid\":\"25575570\",\"cid\":\"1\"},\"dis\":1609055661939,\"ext6\":75,\"eventID\":\"bookRead_show_I\",\"type\":\"shown\",\"ccid\":1,\"bid\":\"25575570\",\"bookStatus\":0,\"bookPay\":0,\"chapterStatus\":0,\"ext1\":{\"font\":18,\"bg\":0,\"pageMode\":1},\"from\":\"bookLib_rankBook_bookClick_C_0_25575570\"}]}"
  #      QQREAD_TIMEURL: "https://mqqapi.reader.qq.com/mqq/addReadTimeWithBid?scene=3001&refer=-1&bid=25575570&readTime=9292&read_type=0&conttype=1&read_status=0&chapter_info=%5B%7B%221%22%3A%7B%22readTime%22%3A9292%2C%22pay_status%22%3A0%7D%7D%5D&sp=-1"
  #     QQREAD_TIMEHD: "{\"ywsession\":\"6jwrxxd7fb8ulxtrf2tkqb09ojyuvi7k\",\"Cookie\":\"ywguid=2571640167;ywkey=ywdNTsLzPMjS;platform=ios;channel=mqqmina;mpVersion=0.38.2;qq_ver=8.4.17;os_ver=iOS 14.3;mpos_ver=1.21.0;platform=ios;openid=ED60B75D67E3B287FC632F4892E9219F\",\"Connection\":\"keep-alive\",\"Content-Type\":\"application/json\",\"Accept\":\"*/*\",\"Host\":\"mqqapi.reader.qq.com\",\"User-Agent\":\"QQ/8.4.17.638 CFNetwork/1209 Darwin/20.2.0\",\"Referer\":\"https://appservice.qq.com/1110657249/0.38.2/page-frame.html\",\"Accept-Language\":\"zh-cn\",\"Accept-Encoding\":\"gzip, deflate, br\",\"mpversion\":\"0.38.2\"}"
        
    steps:
      - name: Checkout
        run: |
          git clone https://github.com/xiaokxiansheng/Qieread.git ~/Qieread
      - name: Use Node.js 12.x
        uses: actions/setup-node@v1
        with:
          node-version: 12.x
      - name: npm install
        run: |
          cd ~/Qieread
          npm install
          npm install cron
          npm install request
          curl ipinfo.io/json
      - name: '运行 【机场签到】'
        run: |
          cd ~/Qieread   
          node Task/checkin.js
